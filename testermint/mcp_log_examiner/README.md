# Testermint Log Examiner

## Introduction

The Testermint Log Examiner is a tool designed to analyze and query log files generated by the Testermint testing framework. It provides a powerful interface for examining log data through SQL queries, making it easier to debug issues, identify patterns, and extract insights from test runs.

This tool is implemented as a Model Context Protocol (MCP) server, allowing it to be used directly with AI assistants like Anthropic's Claude Desktop and Cline (Visual Studio plugin). This enables AI assistants to help you analyze log files by executing queries, interpreting results, and providing insights.

The Testermint Log Examiner is a subproject of the Inference Ignite project, located under the testament/MCP Log Examiner directory. It is designed to run using standard IO (STDIO) for communication with AI assistants.

## How to Build

### Prerequisites

- Java Development Kit (JDK) 21 or later
- Gradle (included as a wrapper)

### Building the Project

1. Clone the repository:
   ```
   git clone <repository-url>
   cd mcp_log_examiner
   ```

2. Build the project using the Gradle wrapper:
   ```
   ./gradlew build
   ```
   This will create a standalone JAR file in the `build/libs` directory named `log-examiner-<version>.jar`.

3. The application is designed to be run as an MCP server through Cline or Claude Desktop:
   ```
   java -jar build/libs/log-examiner-<version>.jar
   ```

   Note that running this command directly will simply start the server, which will wait for input via standard IO (STDIO). It's not meant to be used as a standalone application.

## Setting Up as an MCP Server in Cline and Claude Desktop

> **Note:** The MCP server must be run by the client. The application is designed to run using standard IO (STDIO) for communication.

### For Cline (Visual Studio Plugin)

1. Install the Cline plugin for Visual Studio if you haven't already.

2. Configure Cline to use the Log Examiner as an MCP server:
The config file for MCP servers should look like:
```json
{
  "mcpServers": {
     ... other servers
    "testermintlogs": {
      "command": "java",
      "args": [
        "-jar",
        "{path_to_repo}/gonka/testermint/mcp_log_examiner/build/libs/log-examiner-1.0-SNAPSHOT.jar"
      ],
      "autoApprove": [
        "load-log",
        "log-schema",
        "log-query"
      ]
    }
  }
}
```
You'll need to configure this in the Cline plugin settings within Visual Studio.

### For Claude Desktop

> **Note:** Only Claude Desktop supports MCP servers, not the web version of Claude.

1. In Claude Desktop, add the Log Examiner as an MCP server using the command line:
Claude Desktop MCP servers are found in the Settings->Developer->Edit Config button.
The format for the config should be similar to Cline. Note, though, that Claude does not seem to use $JAVA_HOME, so you will need to specify the full path to the correct java version, as below
```json
{
  "mcpServers": {
     ... other servers
    "testermintlogs": {
      "command": "{path-to-java}/java/current/bin/java",
      "args": [
        "-jar",
        "{path_to_repo}/gonka/testermint/mcp_log_examiner/build/libs/log-examiner-1.0-SNAPSHOT.jar"
      ]
    }
  },
  "globalShortcut": ""
}
```
        
## How to Prompt Cline and Claude for Best Usage

To get the most out of the Log Examiner with AI assistants, use the following prompting strategies. Note that the resources included with the Log Examiner contain instructions that help the AI understand how to examine log files and interpret results. The AI will use these resources to determine how to analyze the log files effectively.
 ### Simple prompt template:
```
Your job is to analyze a large logfile (at `full_path`) using the `testermintlogs` mcp server. The logs are much too large to load directly into the context, so you MUST use this tool to analyze them. Follow these steps:
- Load the test log file
  Load it into the testermintlogs tool by passing in the full path to the file.

- Use the testermintlogs tool to analyze the log per the resources in the tool
  Rely on the Resources made available by the testermintlogs tool.
  Start by loading the Step by Step instructions resource. This will give you an overview of the approach to use for examining the log. There are other critical resources, but load them as needed, not before hand to reduce token usage.
```

### Expanding the prompt
You can expand the prompt depending on the capabilities of the MCP Client. For instance, you could:

#### Add access to test sources:
```
In order to better understand the results, you can look at the test case source code in /testermint/src/. The test code is available there under /testermint/src/test
```

#### Add access to source code:
Adding access to the actual chain source MIGHT yield better analysis, but be sure your code version locally matches the deployed version for the logs.

Keep in mind that this can start to get expensive in terms of tokens used.

```
The source code for the code being tested is in /inference-chain and /decentralized-api . You can use this to better understand failures if needed, but mind the token count.
```
